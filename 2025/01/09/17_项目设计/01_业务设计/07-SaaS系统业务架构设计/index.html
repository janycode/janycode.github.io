

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Jerry(姜源)">
  <meta name="keywords" content="Java,Html,CSS,JavaScript,Python,C,Linux,shell编程经验分享、技术总结、心得体会">
  
    <meta name="description" content="SaaS业务架构的系统性框架，探讨业务架构分析的核心要素，帮助SaaS企业深入剖析目标客户的业务模式，全面理解SaaS业务架构。  一、SaaS业务结构1.目标与步骤SaaS业务架构需要区分两种视角：SaaS企业自身的业务架构、SaaS服务客户的业务架构。 前者聚焦于SaaS公司自身如何研发、销售、交付其软件服务，涵盖产品研发、获客、产品交付和技术支持等业务活动。 后者关注客户如何利用SaaS">
<meta property="og:type" content="article">
<meta property="og:title" content="07-Saas系统业务架构设计">
<meta property="og:url" content="https://janycode.github.io/2025/01/09/17_%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/01_%E4%B8%9A%E5%8A%A1%E8%AE%BE%E8%AE%A1/07-SaaS%E7%B3%BB%E7%BB%9F%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/index.html">
<meta property="og:site_name" content="姜源の云笔记">
<meta property="og:description" content="SaaS业务架构的系统性框架，探讨业务架构分析的核心要素，帮助SaaS企业深入剖析目标客户的业务模式，全面理解SaaS业务架构。  一、SaaS业务结构1.目标与步骤SaaS业务架构需要区分两种视角：SaaS企业自身的业务架构、SaaS服务客户的业务架构。 前者聚焦于SaaS公司自身如何研发、销售、交付其软件服务，涵盖产品研发、获客、产品交付和技术支持等业务活动。 后者关注客户如何利用SaaS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109141011.png">
<meta property="article:published_time" content="2025-01-09T10:52:55.000Z">
<meta property="article:modified_time" content="2025-01-09T06:23:59.185Z">
<meta property="article:author" content="Jerry(姜源)">
<meta property="article:tag" content="系统设计">
<meta property="article:tag" content="架构设计">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109141011.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>07-Saas系统业务架构设计 - 姜源の云笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"janycode.github.io","root":"/","version":"1.9.0","typing":{"enable":true,"typeSpeed":50,"cursorChar":"|","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":false},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"bfff735c897eb60ea49b735096b20e47","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 50vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>姜源の云笔记</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tools/">
                <i class="iconfont icon-slack-fill"></i>
                工具
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" target="_blank" rel="noopener" href="https://yuancodes.github.io/">
                <i class="iconfont icon-notebook"></i>
                Docsify
              </a>
            </li>
          
        
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="07-Saas系统业务架构设计"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Jerry(姜源)
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-01-09 18:52" pubdate>
          星期四, 2025/01/09 18:52:55
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          19k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          160 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">07-Saas系统业务架构设计</h1>
            
            <div class="markdown-body">
              
              <p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109141011.png" srcset="/img/loading.gif" lazyload alt="image-20250109141010203"></p>
<blockquote>
<p>SaaS业务架构的系统性框架，探讨业务架构分析的核心要素，帮助SaaS企业深入剖析目标客户的业务模式，全面理解SaaS业务架构。</p>
</blockquote>
<h1 id="一、SaaS业务结构"><a href="#一、SaaS业务结构" class="headerlink" title="一、SaaS业务结构"></a>一、SaaS业务结构</h1><h2 id="1-目标与步骤"><a href="#1-目标与步骤" class="headerlink" title="1.目标与步骤"></a>1.目标与步骤</h2><p>SaaS业务架构需要区分两种视角：SaaS企业自身的业务架构、SaaS服务客户的业务架构。</p>
<p>前者聚焦于SaaS公司自身如何研发、销售、交付其软件服务，涵盖产品研发、获客、产品交付和技术支持等业务活动。</p>
<p>后者关注客户如何利用SaaS产品支持和改进自身业务，需要分析客户的价值流、业务流程、业务能力和组织架构等内容。理解这两种视角的区别对SaaS企业至关重要。SaaS企业不仅要确保自身高效运营，还需为客户提供有价值的、灵活的且可扩展的解决方案。</p>
<p>本章主要聚焦第二种视角，即SaaS服务客户的业务架构。如果读者想了解SaaS企业自身的业务架构如何设计，可以参考吴昊老师的《SaaS创业路线图》。</p>
<p>在这个阶段，我们的核心目标是深入剖析客户群体的业务模式，全面理解他们的业务架构。要实现这一目标，需要系统性地梳理业务架构的各个核心要素。</p>
<p>市面上有许多业务架构分析体系，各有各的侧重点。有些体系包含过多晦涩难懂的概念、术语。</p>
<p>对于业务架构分析方法，核心目标有两点：一是将复杂业务解构为一系列清晰、合理的抽象模型，使SaaS企业各部门能快速理解并落实业务目标；二是确保这些抽象模型具有强大的复用性和灵活的扩展性。</p>
<p>本章主要参考BIZBOK的业务架构体系，主要因为它概念清晰、逻辑简洁，易于理解和应用。业务架构的核心要素包括：价值流、业务能力、业务流程、业务对象、组织架构。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135625.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>我们将通过以下步骤展开业务架构的分析：</p>
<ul>
<li>价值流分析：识别为客户创造价值的关键流程和环节</li>
<li>业务能力分析：评估和确定组织需要具备的关键能力</li>
<li>业务流程分析：细化业务能力的具体工作流程</li>
<li>业务对象分析：明确并管理业务流程中的关键业务实体和关系</li>
<li>组织架构分析：确定支持业务能力所需的组织单元和关系</li>
</ul>
<h2 id="2-价值流分析"><a href="#2-价值流分析" class="headerlink" title="2.价值流分析"></a>2.价值流分析</h2><p>价值流在业务架构中扮演着关键角色，它是企业战略和日常运营之间的纽带。</p>
<p>通过价值流分析，企业能够清晰地了解如何持续为客户创造价值。这种分析不仅有助于企业实现其价值主张，还为后续的业务能力评估、流程改进和组织结构优化提供了坚实基础。</p>
<h3 id="2-1-从价值主张到价值流"><a href="#2-1-从价值主张到价值流" class="headerlink" title="2.1 从价值主张到价值流"></a>2.1 从价值主张到价值流</h3><p>在商业模式中，价值主张占据了核心地位。</p>
<p>每个企业基本都会强调以“客户为中心”，企业在决定投入某个产品或服务前，首先需明确三个关键问题：它服务于哪个“客户群体”？提供什么价值？目标“客群”能否接受其价格？</p>
<p>价值主张，简单来说，就是客户或其他利益相关者的“愿望清单”，企业需要通过产品或服务来满足这些愿望。</p>
<p>利益相关者们不关心你有多强，他们只在乎你能不能解决他们的实际问题。</p>
<p>那么，如何实现这些”愿望”？答案是通过企业的价值流。价值流概念的引入对企业聚焦”以客户为中心”的理念至关重要。</p>
<p>如果没有梳理清楚价值流，企业可能会面临以下问题：</p>
<ul>
<li>资源分配不当：无法准确识别哪些活动真正为客户创造价值，导致资源浪费在非关键环节上。</li>
<li>客户需求满足不足：缺乏对客户价值的清晰认识，可能导致产品或服务无法有效满足客户需求。</li>
<li>内部协作效率低下：各部门之间缺乏共同目标和清晰的价值创造路径，造成沟通障碍和效率损失。</li>
<li>创新方向偏离：无法准确把握市场需求和价值创造机会，可能导致创新方向与实际需求脱节。</li>
</ul>
<h3 id="2-2-价值流的概念"><a href="#2-2-价值流的概念" class="headerlink" title="2.2 价值流的概念"></a>2.2 价值流的概念</h3><p>在 BIZBOK 中，价值流是核心业务架构要素之一，主要用于描绘企业如何为其客户和其他利益相关者创造和交付价值。</p>
<p>价值流是为客户创造价值的端到端活动集合，涵盖从客户需求到最终价值交付的所有环节。这里的客户可能是最终消费者，也可能是企业内部用户。价值流有两个关键特点：</p>
<p><strong>1、针对特定利益相关者的需求设计。</strong></p>
<p>这意味着每条价值流都有其服务的目标群体，我们需要时刻关注这些群体，满足他们的具体需求。</p>
<p><strong>2、针对这些特定需求，实现闭环价值交付。</strong></p>
<p>价值流会进一步细化为价值流阶段、具体的业务流程、解决方案、产品或服务。我们需要确保这些要素能够有效地串联起来，使最终交付的价值真正满足利益相关者的需求。</p>
<p>这样可以避免出现”各自为战”的情况，即每个人都在辛苦工作，但最终却没有交付实际价值。</p>
<p>那么，利益相关者有哪些？对零售企业而言，利益相关者可大致分为两大类：</p>
<p><strong>1、终端消费者。</strong></p>
<p>他们是企业产品和服务的直接消费者，其需求、偏好和体验直接决定了企业的市场地位和长期发展。因此，企业在战略决策和日常运营中，必须将终端消费者的需求置于核心位置。这是驱动业务增长的关键。</p>
<p><strong>2、其他利益相关者。</strong></p>
<p>包括供应商、员工、股东、合作伙伴等，他们虽然不是直接的消费者，但在企业的运营和发展中扮演着至关重要的角色。</p>
<h3 id="2-2-价值流如何识别？"><a href="#2-2-价值流如何识别？" class="headerlink" title="2.2 价值流如何识别？"></a>2.2 价值流如何识别？</h3><p>在零售行业中，价值流涵盖了从产品开发到客户服务的方方面面，反映了零售商家如何在竞争激烈的市场中脱颖而出。</p>
<p>零售企业的价值流，通常有两类：运营型价值流、支撑和管理型价值流。</p>
<p><strong>1、运营型价值流</strong></p>
<p>这类价值流是企业创造和传递价值给客户的主要途径，直接关系到企业的核心业务运作，包括产品研发、销售、客户服务等方面，对企业的日常运营和收入产生直接影响。这类型的核心价值流包括：</p>
<ul>
<li><strong>产品管理价值流（从创意到产品）</strong>：将一个想法转化为实际产品的全过程。包括市场调研、产品设计、研发、生产和上市等步骤。</li>
<li><strong>市场营销价值流（从机会到潜在客户）</strong>：利用市场机会，通过营销手段吸引潜在客户的过程，目的是让更多人了解并感兴趣。</li>
<li><strong>交易价值流（从潜在客户到订单交付）</strong>：将感兴趣的潜在客户转化为实际购买者，并完成商品交付的过程。涉及销售、订单处理、物流配送等环节。</li>
<li><strong>客户服务价值流（从成交客户到忠诚客户）</strong>：通过优质的售后服务、客户关怀、客户权益，将一次性购买的客户培养成长期支持的忠诚客户的过程。</li>
</ul>
<p><strong>2、支撑和管理型价值流</strong></p>
<p>这类价值流虽不直接面向客户，却满足其他利益相关者的需求，对企业的整体运作起着至关重要的作用。例如，人力资源管理、财务管理、IT支持、法律合规、供应链管理等方面。</p>
<p>这些价值流为核心业务提供必要的支持和保障，确保企业能够高效、合规地运营。</p>
<p>以下以一家蛋糕商家为例，展示了几条常见的价值流，并阐明了利益相关者、价值主张和价值流之间的关系。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135652.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="2-3-价值流阶段如何识别？"><a href="#2-3-价值流阶段如何识别？" class="headerlink" title="2.3 价值流阶段如何识别？"></a>2.3 价值流阶段如何识别？</h3><p>价值流通常会包含多个价值流阶段，每个阶段都具有其特定的价值增量，共同确保为客户交付完整价值。</p>
<p>如何划分价值流阶段？价值流的阶段应尽可能与客户旅程的阶段相匹配，建立清晰的对应关系。梳理客户旅程是提升客户体验的关键步骤。通过对客户旅程进行端到端的分析，确保涵盖所有重要阶段。</p>
<p>以一家蛋糕企业为例，对于一个蛋糕产品的消费者来说，他的客户旅程可划分为以下几个阶段：</p>
<ul>
<li>想买蛋糕：客户意识到自己想要买蛋糕，可能是为特殊场合（如生日、婚礼或庆典）准备，或单纯想品尝甜点。</li>
<li>寻找店铺并对比：客户开始寻找并对比不同的蛋糕品牌或店铺，寻找能满足其特定需求（如款式、口味、预算、定制服务）的选项。</li>
<li>决定到哪买：客户决定在哪家蛋糕店购买，并确定所需的蛋糕种类、口味、装饰以及交付方式。</li>
<li>正式购买：客户正式下单并支付费用，确认交付时间和方式（如店内自提或配送服务）。</li>
<li>收货：客户接收蛋糕，体验商家的交付服务。</li>
</ul>
<p>基于客户旅程的关键活动，我们识别出各个价值流阶段，每个阶段都有相应价值。理论上，如果某阶段无法增加或满足客户所需价值，可以考虑舍弃。</p>
<p>我们以市场营销价值流为例，可以划分为4个价值流阶段：</p>
<ul>
<li>客户洞察：通过市场调研和客户数据分析，了解客户需求、痛点和行为模式。这有助于企业深入理解客户，让品牌更容易触达目标客户，并设计出有针对性的营销方案。</li>
<li>品牌推广：向客户展示产品或服务的独特卖点，帮助客户在考虑阶段更加关注你的品牌。</li>
<li>场景营销：此时客户已筛选出几个可能的品牌，正在做出最终购买决定。通过针对特定客户场景（如生日、婚礼、周年纪念等）的个性化营销，增加产品吸引力并促使客户做出购买决策。</li>
<li>触达转化：在客户购买前，通过流量渠道、企业微信、短信等渠道发放福利、多次提醒，激励客户最终完成交易。</li>
</ul>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135645.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="3-业务流程"><a href="#3-业务流程" class="headerlink" title="3.业务流程"></a>3.业务流程</h2><h3 id="3-1-业务流程的概念"><a href="#3-1-业务流程的概念" class="headerlink" title="3.1 业务流程的概念"></a>3.1 业务流程的概念</h3><p>业务流程是企业为实现目标而制定的一套系统化的工作方法。它由一系列有序的业务活动组成，按照既定规则将资源（输入）转化为有价值的结果（输出）。</p>
<p>在业务架构分析阶段，业务流程发挥着关键作用：</p>
<ul>
<li>明确业务运作的方式：业务流程详细描述了企业的各项业务活动及其顺序和关联，帮助深入理解企业如何将资源转化为产品或服务。</li>
<li>识别改进机会：通过分析现有的业务流程，可以发现流程中的瓶颈、重复和低效环节，为流程优化和业务改进提供依据。</li>
<li>支持战略对齐：业务流程分析确保业务运营与企业的战略目标保持一致，促进战略的有效实施和落地。</li>
<li>支持系统架构设计：业务流程为信息系统的设计和开发提供了清晰的业务需求，确保技术解决方案与业务需求紧密匹配。</li>
</ul>
<p>业务流程通常有2大核心视角：</p>
<ul>
<li>端到端流程：强调跨部门的协作与整体效率，贯穿整个业务链条，从客户需求的起点到最终满足的终点。</li>
<li>职能流程：聚焦于各个部门内部的专业化分工，确保每个职能领域的高效运作。</li>
</ul>
<p>这两种流程相辅相成，共同构建了企业的完整业务体系。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135706.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="3-2-端到端流程"><a href="#3-2-端到端流程" class="headerlink" title="3.2 端到端流程"></a>3.2 端到端流程</h3><p><strong>1、端到端流程的定义</strong></p>
<p>简单来说，端到端流程就是从客户需求发起，到最终客户需求被满足的整个过程。</p>
<p>“价值流”与”端到端流程”常被拿来比较。那么，这两者之间有何区别？</p>
<p>“价值流”是企业业务的战略蓝图，提供宏观视角，概括了整体价值创造过程。而”端到端流程”则是这个蓝图的具体实施方案，详细描绘了每个环节的操作细节。</p>
<p>前文中讲到，通过梳理价值流，我们可以聚焦客户需求，发现哪些环节为客户创造价值，哪些环节存在浪费。然后，基于这些环节，形成高效的端到端流程。</p>
<p>它们之间的关系如图所示。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135713.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>从价值流到端到端流程，就是把企业价值创造的过程进行细化。端到端流程的作用包括：</p>
<ul>
<li>全面了解业务：通过梳理从需求发起到满足的完整过程，展示各环节如何衔接以及潜在问题。这就像一张清晰的路线图，为企业指明工作方向。</li>
<li>聚焦核心目标：端到端流程始于客户的真实需求。通过确保流程中的各个团队和部门都围绕这些需求展开工作，我们能够为客户交付真正的价值，同时避免资源浪费。</li>
<li>增强企业响应能力：面对瞬息万变的市场和客户需求，清晰的流程让企业能够迅速调整策略。当新需求出现时，企业可以快速组合现有的流程模块，及时响应市场机会。</li>
</ul>
<p><strong>2、端到端流程的颗粒度</strong></p>
<p>端到端流程的颗粒度与终端客户的典型需求密切相关。因此，划分端到端流程的核心在于准确定位终端客户及其典型需求。</p>
<p>以一家蛋糕商家为例，其端到端流程可能包括：</p>
<ul>
<li>线上预订，配送到家流程：客户在线上预订蛋糕，选好配送时间，商家按约定时间配送到家。</li>
<li>客户到店，门店服务流程：针对亲临实体店的客户，门店销售和服务的全过程。</li>
</ul>
<h3 id="3-3-职能流程"><a href="#3-3-职能流程" class="headerlink" title="3.3 职能流程"></a>3.3 职能流程</h3><p><strong>1、职能流程的定义</strong></p>
<p>职能流程是企业各部门为完成特定任务而制定的工作规范。</p>
<p>通过梳理和完善职能流程，各部门的工作流程变得清晰明确。这为构建端到端流程提供了可靠的基础模块。职能流程的核心作用包括：</p>
<ul>
<li>审视企业管理的完整性：由于企业组织架构通常基于职能分工，梳理各职能流程就像对企业进行全面体检，找出需要改进的方面。</li>
<li>构建端到端流程：有了职能流程，就能像搭积木一样构建出端到端流程。缺乏职能流程架构，端到端流程就需要反复梳理，导致大量资源浪费。</li>
</ul>
<p><strong>2、职能流程的颗粒度</strong></p>
<p>职能流程如何切分？一种较为直观的方式是根据企业的组织架构进行划分。例如，一个蛋糕商家有研发部、生产部、品牌部、直营店部、配送部等部门，就相应设计研发流程、生产流程、品牌推广流程等职能流程。</p>
<p>然而，这种方式直接将组织架构与职能流程绑定。如果组织架构设计不合理，职能流程也将随之不合理。更重要的是，这种方法无法通过职能流程发现组织的问题，从而难以打破组织壁垒。</p>
<p>切分职能流程的关键在于以”业务对象”为核心进行划分。</p>
<p>业务对象指在业务运营中核心关注的人、事、物。例如客户、产品、订单、合同、供应商等。</p>
<p>以业务对象管理闭环为核心来切分职能流程，可确保：</p>
<ul>
<li>划分标准清晰：企业能统一职能流程的颗粒度，避免过度拆分或界定模糊。</li>
<li>避免重复建设：职能流程涵盖业务对象相关的完整事项和信息。如果两个职能流程围绕同一个或同类业务对象进行操作，很可能可以合并。</li>
</ul>
<p>以蛋糕加工作业流程为例，从提交加工单开始，经过领料、配料、制作、裱花，直到加工完成。整个流程围绕”加工单”这一核心业务对象展开。不应将领料、配料等环节拆分成独立流程，这可能导致流程不闭环，徒增管理复杂性。</p>
<h3 id="3-4-示例：零售企业的业务流程"><a href="#3-4-示例：零售企业的业务流程" class="headerlink" title="3.4 示例：零售企业的业务流程"></a>3.4 示例：零售企业的业务流程</h3><p>下图展示了一个典型的线上预订蛋糕并配送到家的端到端流程，其中包含了多个部门的职能流程。例如，客服部门负责接收、确认蛋糕细节、派单。中央厨房负责蛋糕的制作，物流部门则负责配送。</p>
<p>这些部门各自的工作流程体现了职能流程的具体实施。每个部门的泳道内的活动序列，准确地反映了该部门在整个业务流程中的职责和具体操作步骤。</p>
<p>从整体来看，我们可以清晰地观察到各个职能部门如何协同工作，共同完成从接收订单到最终交付的全过程。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135735.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="4-业务能力"><a href="#4-业务能力" class="headerlink" title="4.业务能力"></a>4.业务能力</h2><h3 id="4-1-业务能力的概念"><a href="#4-1-业务能力的概念" class="headerlink" title="4.1 业务能力的概念"></a>4.1 业务能力的概念</h3><p>简单来说，业务能力是企业“做某事的能力”。</p>
<p>业务能力描述了企业当前和未来应对挑战的能力，即企业能做什么或需要做什么。业务能力建模的关键在于定义了企业做什么，而不是如何做（由业务流程描述）。</p>
<p>以人才招聘为例，大多数公司都需要”招聘人才”这项业务能力。”招聘人才”明确了要做什么，但并未详述如何执行。这可能是招聘HR通过招聘网站吸引候选人，也可能是将任务外包给猎头公司。</p>
<p>准确定义的业务能力通常具有高度稳定性。过去几十年中，尽管招聘流程、技术和模式经历了翻天覆地的变化，”招聘人才”这项核心业务能力依然保持不变。</p>
<p>正是由于业务能力的这些特征，它对构建IT系统架构提供了至关重要的帮助。围绕业务能力构建的IT系统不仅具有更稳定的结构，还更容易扩展。</p>
<p>当需要推出新产品或服务时，合理复用现有能力是最高效的方案。</p>
<h3 id="4-2-业务能力的构成"><a href="#4-2-业务能力的构成" class="headerlink" title="4.2 业务能力的构成"></a>4.2 业务能力的构成</h3><p>业务能力独立于组织的人员、流程、信息、资源。准确地说，这些业务要素是支撑业务能力而存在的。同样以“招聘人才”为例，“招聘人才”包括的业务要素可能有：</p>
<ul>
<li>人员：人力资源团队。</li>
<li>业务流程：吸引、筛选、面试、雇用。</li>
<li>信息：职位描述、招聘需求、应聘者简历、面试评估表、入职文件等。</li>
<li>资源：招聘系统、人事系统。</li>
</ul>
<h3 id="4-3-业务流程与业务能力的区别"><a href="#4-3-业务流程与业务能力的区别" class="headerlink" title="4.3 业务流程与业务能力的区别"></a>4.3 业务流程与业务能力的区别</h3><ul>
<li>业务能力：关注企业核心业务的能力和结果，不涉及具体的流程分解。</li>
<li>业务流程：专注于流程本身，面向特定场景，通过活动组合解决具体问题，是企业日常运作的关键动作。</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>业务能力</th>
<th>业务流程</th>
</tr>
</thead>
<tbody><tr>
<td>关注点</td>
<td>做什么（what）</td>
<td>怎么做（how）</td>
</tr>
<tr>
<td>业务目标</td>
<td>职能专业化</td>
<td>协作顺畅</td>
</tr>
<tr>
<td>表现形式</td>
<td>抽象的、模块化</td>
<td>具体的、端到端</td>
</tr>
<tr>
<td>相互关系</td>
<td>为流程提供支持</td>
<td>向能力提需求</td>
</tr>
</tbody></table>
<p>业务流程的不同环节，需要对应的业务能力来支持，业务能力可以被多个业务流程复用。业务能力被复用的次数越多，企业在业务能力建设上的收益就越大。</p>
<p>如图所示，以订单派单的业务流程为例，接收订单、派单环节依赖订单履约能力，确认蛋糕订单细节环节依赖客户服务能力。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135755.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="4-4-业务能力如何识别？"><a href="#4-4-业务能力如何识别？" class="headerlink" title="4.4 业务能力如何识别？"></a>4.4 业务能力如何识别？</h3><p>企业可以采用多种方法来有效识别业务能力。每种方法都有其特点，企业应根据自身实际情况和需求灵活选择。下面我们将介绍几种常见且行之有效的识别方法。</p>
<p><strong>1、围绕业务对象进行识别。</strong></p>
<p>这种方法是业务能力识别中最基础且推荐的梳理方式。业务对象作为企业运营的基本要素，不仅能有效帮助企业识别关键业务能力，还能确保这些能力的全面性和稳定性。</p>
<p>举例来说，通过深入分析”客户”、”商品”、”库存”、”渠道”等核心业务对象，企业可以相应地识别出”客户服务”、”商品销售管理”、”库存管理”、”渠道运营”等关键业务能力。</p>
<p><strong>2、基于职能流程来识别业务能力</strong></p>
<p>对于已经建立良好流程基础的企业，通过分析各个职能部门的业务流程，企业可以迅速识别出对应的业务能力。这确保业务能力与企业实际运营的紧密联系，同时也有助于发现可能被忽视的关键能力。</p>
<p><strong>3、参考业界成熟模型</strong></p>
<p>成熟的行业模型可以帮助企业识别和定义自己的业务能力。这些模型提供了很好的起点。不过，企业需根据自己的实际情况来调整和定制这些模型。</p>
<p>以下是一些常用的行业模型：</p>
<ul>
<li>APQC流程分类框架：提供了各个行业的标准化业务流程和能力分类。</li>
<li>IBM Industry Models：针对特定行业提供详细的业务能力模型，涵盖零售、银行、保险、电信等多个领域。</li>
<li>SAP Retail Business Capability Framework：专门针对零售行业的业务能力框架，涵盖了从采购到销售的各个环节。</li>
</ul>
<p><strong>4、参考成熟的B端软件来识别</strong></p>
<p>在识别业务能力时，成熟的B端软件可以作为一个重要的参考来源。这些软件通常是基于行业最佳实践和广泛的市场需求开发的，因此能够反映出特定领域中普遍需要的业务能力。</p>
<p>例如，ERP系统通常包含了财务管理、供应链管理、人力资源管理等模块，这些模块可以直接对应到相关的业务能力。</p>
<p>同样，CRM（客户关系管理）系统中的销售管理、客户服务、市场营销等功能，也能帮助企业识别出这些领域的关键业务能力。</p>
<p>通过分析这些软件的功能模块和特点，企业可以全面了解行业标准和最佳实践，从而更准确地定义和完善自身的业务能力体系。</p>
<h3 id="4-5-示例：零售企业的业务能力"><a href="#4-5-示例：零售企业的业务能力" class="headerlink" title="4.5 示例：零售企业的业务能力"></a>4.5 示例：零售企业的业务能力</h3><p>如图所示，我们详细展示了一个典型零售企业的业务能力体系，涵盖了L1和L2两个层级。</p>
<p>核心运营能力直接面向终端客户，包括采购管理、供应链管理和商品销售管理等。这些能力直接影响企业的市场表现和客户满意度，是企业竞争力的核心体现。</p>
<p>其次是企业运营支持能力。这部分能力虽然不直接面向客户，但为企业的日常运营提供了重要支撑。包括财务管理、IT部署和管理以及员工管理等。这些能力确保了企业内部运作的效率和稳定性。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135801.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="5-业务对象"><a href="#5-业务对象" class="headerlink" title="5.业务对象"></a>5.业务对象</h2><h3 id="5-1-业务对象的概念"><a href="#5-1-业务对象的概念" class="headerlink" title="5.1 业务对象的概念"></a>5.1 业务对象的概念</h3><p>业务对象指企业在业务运营中核心关注的人、事、物，承载了业务运作和管理决策涉及的重要信息。例如客户、产品、订单、合同、供应商等。</p>
<h3 id="5-2-如何识别业务对象？"><a href="#5-2-如何识别业务对象？" class="headerlink" title="5.2 如何识别业务对象？"></a>5.2 如何识别业务对象？</h3><p><strong>1、物理可感知的实体</strong></p>
<p>一种是物理可感知的实体，如客户、商品、人员、设备等，它们在特定的时间和空间中真实存在，大部分能看得见摸得着。</p>
<p><strong>2、管理记录</strong></p>
<p>另一种是”管理记录”，即企业业务活动的可追溯凭证。这些信息载体通常以文档、表格等形式存在，记录了业务流程中的关键数据和状态信息，也就是所谓的”表证单书”。</p>
<p>“表证单书”在企业信息管理和流程控制中扮演着不可或缺的角色。它们不仅帮助企业规范化和标准化信息传递，还确保了业务流程的透明度和可追溯性。</p>
<p>我们以在线预订蛋糕，配送到家的流程为例：</p>
<p>一位消费者在线上预订了次日的蛋糕，满怀期待地等待着。然而，约定的时间悄然过去，蛋糕却迟迟未送达。一场满怀期待的生日就被毁了，消费者的期待转为愤怒的投诉。</p>
<p>管理者接到投诉后，首先查看订单状态，发现订单处于”待发货”状态。由此判断，订单已流转至中央厨房，订单流转环节无误。</p>
<p>接着检查相应的加工单状态，发现加工单已完成。这表明加工环节也未出问题。</p>
<p>最后查看配送单状态，发现配送单仍处于”待配送”状态。进一步了解，原来是分配的配送员因个人紧急原因，无法完成配送。</p>
<p>通过这一追溯过程，管理者确定问题出在配送环节。这一发现为后续改进流程、防止类似情况再次发生提供了依据。</p>
<p>如果缺乏这些清晰准确的管理记录，管理者可能一头雾水，无法确定责任归属。</p>
<h3 id="5-3-业务对象的属性"><a href="#5-3-业务对象的属性" class="headerlink" title="5.3 业务对象的属性"></a>5.3 业务对象的属性</h3><p>业务对象包含多个细节信息，这些信息被称为属性。属性是描述业务对象特征和状态的具体数据项，它们共同构成了业务对象的完整定义。</p>
<p>每个属性都代表了业务对象的一个特定维度，如名称、日期、数量或状态等。</p>
<p>通过这些属性，我们能够全面地描述和理解业务对象，从而有效地管理和利用这些信息来支持业务运营和决策制定。</p>
<p>我们以零售商家的客户订单为例，至少需要包含以下属性：</p>
<ul>
<li>商店在某段时间内销售了哪些零售商品？</li>
<li>零售商品在什么时候售出？</li>
<li>商品在商店的什么位置售出？</li>
<li>谁卖出了这些零售商品？</li>
<li>商品售价是多少？</li>
<li>交易中赚取了哪些费用？</li>
<li>对商品应用了哪些特殊折扣、价格调整、降价等方式？</li>
<li>为结算这笔交易，收取多少现金？</li>
<li>使用哪种支付方式支付的？</li>
</ul>
<h2 id="6-组织架构"><a href="#6-组织架构" class="headerlink" title="6.组织架构"></a>6.组织架构</h2><p>组织架构是按照企业战略来设定和安排部门和岗位，形成稳定且科学的管理体系。这个体系保证企业能适应业务需求并支持企业发展。</p>
<p>组织架构对业务架构至关重要。在梳理业务流程时，要根据流程的运作规律和处理逻辑，在各个节点安排合适的人员，这样才能确保组织得灵活性和责任明确。</p>
<p>同时，业务架构也需要考虑组织的业务发展和需求，对部门的岗位设置、人员配置、角色定义、权限职责以及考核机制进行清晰规划，确保业务流程中每个环节能顺利运作。</p>
<h3 id="6-1-组织架构的核心内容"><a href="#6-1-组织架构的核心内容" class="headerlink" title="6.1 组织架构的核心内容"></a><strong>6.1 组织架构的核心内容</strong></h3><ul>
<li>层级结构：明确企业内部的上下级关系，即谁对谁负责，谁向谁汇报。通常分为高层管理、中层管理和基层员工。</li>
<li>部门划分：根据职能、产品、地区或客户等因素划分不同部门，各部门负责特定的业务活动。例如，常见的职能部门包括市场部、财务部和生产部等。</li>
<li>职责和权限：明确每个职位的具体职责和权限范围，确保各岗位员工了解自己的工作内容和权限。这有助于避免职责重叠或权责不清，从而提高工作效率。</li>
<li>沟通协作：制定不同层级和部门之间的沟通方式和渠道，确保信息流动顺畅。有效的沟通和协调机制能促进问题解决、决策制定和工作推进。</li>
<li>指挥链：建立从最高领导到基层员工的清晰指挥链，确保决策和指令能够有效传达和执行。指挥链通常呈纵向结构，有助于维持组织的统一性和协调性。</li>
</ul>
<h3 id="6-2-常见的组织架构类型"><a href="#6-2-常见的组织架构类型" class="headerlink" title="6.2 常见的组织架构类型"></a>6.2 常见的组织架构类型</h3><ul>
<li>职能型组织架构：根据主要职能划分部门，如生产、销售、财务等，每个部门负责特定的职能。</li>
<li>产品型组织架构：根据产品或服务划分部门，每个部门负责一个或多个产品线的全部活动。</li>
<li>区域型组织架构：根据地理区域划分部门，每个区域部门负责该地区的业务活动。</li>
<li>矩阵型组织架构：结合职能型和项目型架构，员工同时隶属于职能部门和项目团队，适用于复杂项目管理。</li>
<li>扁平型组织架构：减少管理层级，缩短管理链条，增强灵活性和创新能力。</li>
</ul>
<h3 id="6-3-示例：零售企业的组织架构"><a href="#6-3-示例：零售企业的组织架构" class="headerlink" title="6.3 示例：零售企业的组织架构"></a>6.3 示例：零售企业的组织架构</h3><p>通常情况下，零售企业会从单店经营开始，业务不断扩展，开设更多的门店，达到中小连锁企业规模，员工数量达到了几十人或上百人。</p>
<p>中小连锁企业下设部门通常包括：研发部、生产部、品牌部、直营店部、配送部、品控部、仓储部、采购部、大客户部、行政人事部、信息技术部。</p>
<ul>
<li>研发部门：负责新品研发、产品升级和口味改进，确保产品持续保持市场竞争力。</li>
<li>生产部门：管理生产制造、品质控制和生产计划，确保产品质量和产量的平衡。</li>
<li>品牌部门：执行品牌策划、市场推广和形象宣传，提升品牌知名度和美誉度。</li>
<li>直营店部门：负责直营店的日常运营、销售业绩和客户服务，优化店铺运营效率和客户满意度。</li>
<li>配送部门：处理产品配送、物流管理和仓储管理，保证配送的及时性和准确性。</li>
<li>品控部门：进行产品品质检测和质量控制，维持产品质量的稳定性。</li>
<li>仓储部门：管理原材料、半成品和成品的仓储，以及物资采购，确保生产和销售的流畅性。</li>
<li>采购部门：从供应商处采购原材料、半成品和包装材料，确保原材料的及时供应和合理定价。</li>
<li>大客户部门：开拓大客户并提供定制化服务，提高大客户的满意度和忠诚度。</li>
<li>行政人事部门：负责企业的招聘、人事管理和行政管理，保证企业运营的法律合规性和人力资源的稳定性。</li>
<li>信息技术部门：负责企业IT系统的改造、实施和维护，确保系统、服务器和网络的稳定运行。</li>
</ul>
<p>下图所示为一个中小连锁企业的组织架构图。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135842.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<blockquote>
<p>本文已收录于，我的技术网站：<a target="_blank" rel="noopener" href="https://tangshiye.cn/">tangshiye.cn</a> 里面有，算法Leetcode详解，面试八股文、BAT面试真题、简历模版、架构设计，等经验分享。</p>
</blockquote>
<h1 id="二、SaaS系统架构设计"><a href="#二、SaaS系统架构设计" class="headerlink" title="二、SaaS系统架构设计"></a>二、SaaS系统架构设计</h1><h2 id="1-多租户"><a href="#1-多租户" class="headerlink" title="1.多租户"></a>1.多租户</h2><p>多租户是SaaS领域的特有产物，在SaaS服务中，租户是指使用SaaS系统的客户，租户不同于用户，例如，B端SaaS产品，用户可能是某个组织下的员工，但整个企业组织是SaaS系统的租户。</p>
<p>多租户技术是一种软件架构技术，可以实现多个租户共享系统实例，并且租户间能够实现数据与行为的隔离。</p>
<h3 id="传统软件模式-VS-SaaS模式"><a href="#传统软件模式-VS-SaaS模式" class="headerlink" title="传统软件模式 VS SaaS模式"></a>传统软件模式 VS SaaS模式</h3><p>传统软件项目一般是指，面向客户开发一套特定的软件系统，并部署在独立的环境中，通常是企业内部环境。</p>
<p>而SaaS模式，是将软件服务部署到云端环境，可以面向不同的客户提供相同的软件服务。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140158.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h2 id="2-SaaS多租户隔离模式"><a href="#2-SaaS多租户隔离模式" class="headerlink" title="2.SaaS多租户隔离模式"></a>2.SaaS多租户隔离模式</h2><p>对于SaaS模式，多租户间的资源隔离是非常基础的能力，出于成本和运营效率考虑，SaaS服务商需要构建多租户可同时访问软件的环境，不同租户虽然访问同一套SaaS产品服务，但资源访问需要严格隔离开。</p>
<p>SaaS资源隔离包含几个层次：</p>
<ul>
<li>第一层是SaaS系统底层所涉及到的计算、存储、网络等资源的隔离。</li>
<li>第二层是系统基础数据的隔离，主要包括组织，用户，角色，权限，产品能力授权关系等。</li>
<li>第三层是系统使用过程中，各类业务动态数据的隔离，例如业务单据、操作记录等。</li>
</ul>
<p>多租户架构主要是解决第一层的隔离问题，即计算、存储、网络等资源的隔离。为了实现多租户隔离架构，我们先要搞清楚常见的几种多租户隔离模式。</p>
<h3 id="2-1-竖井隔离模式"><a href="#2-1-竖井隔离模式" class="headerlink" title="2.1 竖井隔离模式"></a>2.1 竖井隔离模式</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140201.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>有些SaaS服务商会选择竖井隔离模式，即每个租户都运行在隔离的一套资源中。有人会说，这不就是传统软件模式吗，为什么会是SaaS模式呢？但如果这些竖井式的资源，拥有标准化的租户身份识别、入驻流程、计费体系、部署流程、运营流程，那边它依然是SaaS模式，只不过每个客户都有一套端到端的基础设施。</p>
<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><ul>
<li>满足强隔离需求：一些客户为了系统和数据的安全性，可能提出非常严格的隔离需求，期望软件产品能够部署在一套完全独立的环境中，不和其他租户的应用实例、数据放在一起。</li>
<li>计费逻辑简单：SaaS服务商需要针对租户使用资源进行计费，对于复杂的业务场景，计算、存储、网络资源间的关系同样也会非常复杂，计费模型是很有挑战的，但在竖井模式下，计费模型相对来说是比较简单的。</li>
<li>降低故障影响面：因为每个客户的系统都部署在自己的环境中，如果其中一个环境出现故障，并不会影响其他客户使用软件服务。</li>
</ul>
<h4 id="劣势"><a href="#劣势" class="headerlink" title="劣势"></a>劣势</h4><ul>
<li>规模化问题：由于租户的SaaS环境是独立的，所以每入驻一个租户，就需要创建和运营一套SaaS环境，如果只是少量的租户，还可能可以管理，但如果是成千上万的租户，管理和运营这些环境将会是非常大的挑战。</li>
<li>成本问题：每个租户都有独立的环境，花费在单个客户上的成本将非常高，会大幅削弱SaaS软件服务的盈利能力。</li>
<li>敏捷迭代问题：SaaS模式的一个优势是能够快速响应市场需求，迭代产品功能。但竖井隔离策略会阻碍这种敏捷迭代能力，因为更新、管理、支撑这些租户的SaaS环境，会变得非常复杂和低效。</li>
<li>系统管理与监控：在同一套环境中，对部署的基础设施进行管理与监控，是较为简单的。但每个租户都有独立的环境，在这种非中心化的模式下，对每个租户的基础设施进行管理与监控，同样也是非常复杂、困难的。</li>
</ul>
<h3 id="2-2-共享模式"><a href="#2-2-共享模式" class="headerlink" title="2.2 共享模式"></a>2.2 共享模式</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140204.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>相信很多SaaS服务商会优先选择共享模式，即多租户共享一套基础设施资源，这样能让SaaS软件服务更加高效、敏捷、低成本。</p>
<h4 id="优势-1"><a href="#优势-1" class="headerlink" title="优势"></a>优势</h4><ul>
<li>高效管理：在共享策略下，能够集中化地管理、运营所有租户，管理效率非常高。同时，对基础设施配置管理、监控，也将更加容易。相比竖井策略，产品的迭代更新会更快。</li>
<li>成本低：SaaS服务商的成本结构中，很大一块是基础设施的成本。在共享模型下，服务商可以根据租户们的实际资源负载情况，动态伸缩系统，这样基础设施的利用率将非常高。</li>
</ul>
<h4 id="劣势-1"><a href="#劣势-1" class="headerlink" title="劣势"></a>劣势</h4><ul>
<li>租户相互影响：由于所有租户共享一套资源，当其中一个租户大量占用机器资源，其他租户的使用体验很可能受到影响，在这种场景下，需要在技术架构上设计一些限制措施（限流、降级、服务器隔离等），让影响面可控。</li>
<li>租户计费困难：在竖井模型下，非常容易统计租户的资源消耗。然而，在共享模型下，由于所有租户共享一套资源，需要投入更多的精力统计单个租户的合理费用。</li>
</ul>
<h3 id="2-3-分域隔离模式"><a href="#2-3-分域隔离模式" class="headerlink" title="2.3 分域隔离模式"></a>2.3 分域隔离模式</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140308.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>传统大企业更喜欢私有化部署、个性化交付的传统模式，因为他们需要更强的管控和更高的安全性。然而，中小企业付费能力有限，需求往往也更加标准化，所以更喜欢价格更低的、订购更简单的SaaS产品。</p>
<p>为了满足不同客户的需求，还有一种混合了竖井模型与共享模型的模式，即分域隔离模式。在该模式下，会细分基础域、专用域，基础域是使用共享模型，所有租户共享一套资源；而专用域是使用竖井模型，每个租户都有独立的资源环境。</p>
<p>对于大多数中小客户来说，他们都是在基础域环境使用SaaS产品，只有少量的大客户会在专用域使用SaaS产品，通常他们付费能力强，有强烈的强隔离需求。</p>
<p>但需要注意的是，为了避免多套产品版本出现，SaaS服务商需要保证基础域、专用域的产品版本一致，个性化的部分尽可能通过构建PaaS平台，让ISV参与建设。否则，一旦SaaS产品的标准化程度降低，后续各版本的维护将变成灾难。</p>
<h2 id="3-多租户系统的定位"><a href="#3-多租户系统的定位" class="headerlink" title="3.多租户系统的定位"></a>3.多租户系统的定位</h2><p>了解各种多租户隔离模式后，我们来总结下多租户系统的定位。</p>
<p>多租户系统是为了满足多用户使用一套产品，并实现用户间的数据与行为隔离，但根据用户需求不同，可以共享或隔离软硬件资源，系统架构上能够灵活支持多种隔离模式。</p>
<p>多租户系统需要具备的能力：</p>
<ul>
<li>多个租户支持共享一套云资源，如计算、存储、网络资源等。单个租户也可以独占一套云资源。</li>
<li>多个租户间能够实现数据与行为的隔离，能够对租户进行分权分域控制。</li>
<li>租户内部能够支持基于组织架构的管理，可以对产品能力进行授权和管理。</li>
<li>不同的产品能力可以根据客户需求，支持运行在不同的云资源上。</li>
</ul>
<h2 id="4-多租户概念模型"><a href="#4-多租户概念模型" class="headerlink" title="4.多租户概念模型"></a>4.多租户概念模型</h2><h3 id="多租户核心概念"><a href="#多租户核心概念" class="headerlink" title="多租户核心概念"></a>多租户核心概念</h3><ul>
<li>租户：一般指一个企业客户或个人客户，租户之间数据与行为是隔离的。</li>
<li>用户：在某个租户内的具体使用者，可以通过使用账户名、密码等登录信息，登录到SaaS系统使用软件服务。</li>
<li>组织：如果租户是一个企业客户，通常会拥有自己的组织架构。</li>
<li>员工：是指组织内部具体的某位员工。</li>
<li>解决方案：为了解决客户的某类型业务问题，SaaS服务商将产品与服务组合在一起，为商家提供整体的打包方案。</li>
<li>产品能力：指的是SaaS服务商对客户售卖的产品应用，特指能够帮助客户实现端到端场景解决方案闭环的能力。</li>
<li>资源域：用来运行1个或多个产品应用的一套云资源环境。</li>
<li>云资源：SaaS产品一般都部署在各种云平台上，例如阿里云、腾讯云、华为云等。对这些云平台提供的计算、存储、网络、容器等资源，抽象为云资源。</li>
</ul>
<h3 id="概念模型设计"><a href="#概念模型设计" class="headerlink" title="概念模型设计"></a>概念模型设计</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140357.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li>SaaS平台可以创建与管理多个平台用户、多个租户、多个资源域。</li>
<li>单个平台用户可以关联到多个租户下，例如，平台用户张三，可以是租户A的用户，也可以是租户B的用户。单个租户下可以拥有多个用户。</li>
<li>单个租户可以订购多个解决方案，解决方案可以包多个产品能力，产品能力运行在某个资源域上。</li>
<li>组织单元间有上下级关系，单个组织下可以有多个员工，员工与单个用户进行绑定。</li>
</ul>
<h2 id="5-多租户核心场景"><a href="#5-多租户核心场景" class="headerlink" title="5.多租户核心场景"></a>5.多租户核心场景</h2><h3 id="租户内部模型关系"><a href="#租户内部模型关系" class="headerlink" title="租户内部模型关系"></a>租户内部模型关系</h3><p>对SaaS产品来说，租户是最顶层的概念，租户内部拥有组织、用户、产品能力、云资源等模型，租户就像租了一套大房子，其他模型都是房子内部的家具或设施。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140507.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="租户身份识别"><a href="#租户身份识别" class="headerlink" title="租户身份识别"></a>租户身份识别</h3><p>在各种隔离模式下，识别租户身份，获取租户的资源配置，是非常关键的。当一个用户登录SaaS系统后，系统会返回租户上下文信息，上下文会包含用户绑定的租户信息，以及隔离模式。</p>
<p>租户上下文信息会被附加在每一次系统交互中，贯穿整个系统调用链路，让上游调用方知道路由到哪些下游资源。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140511.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="租户计费计量管理"><a href="#租户计费计量管理" class="headerlink" title="租户计费计量管理"></a>租户计费计量管理</h3><p>在竖井隔离模式下，由于资源本身就是隔离的，所以可以根据占用的计算、存储、网络资源来计费计量，逻辑相对简单。</p>
<p>在共享模式下，计费计量就比较复杂，我们要能准确地采集到各个租户对实际资源的使用情况，一般会根据请求并发量、存储容量、数据对象数量等数据来进行组合计费。</p>
<h3 id="多租户系统应用架构"><a href="#多租户系统应用架构" class="headerlink" title="多租户系统应用架构"></a>多租户系统应用架构</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109140519.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h1 id="三、SaaS应用架构设计"><a href="#三、SaaS应用架构设计" class="headerlink" title="三、SaaS应用架构设计"></a>三、SaaS应用架构设计</h1><h2 id="1-应用架构概述"><a href="#1-应用架构概述" class="headerlink" title="1.应用架构概述"></a>1.应用架构概述</h2><p>应用架构就像整个SaaS系统的骨架，决定了系统的整体结构和各个组件之间的关系。接下来，我们会深入探讨应用架构的三个核心要素：应用服务、应用结构和应用交互。这些要素共同构成了一个体系化的SaaS系统架构。如图所示。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135328.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>通常，应用架构设计包括以下几个步骤：</p>
<ul>
<li>识别应用服务：根据业务架构，把业务需求转化为IT系统，找出关键的应用服务。</li>
<li>划分应用结构：设计应用结构，以及与业务流程、数据之间的关系，明确各部分的职责。</li>
<li>设计应用交互：规划各个应用结构之间如何交互和集成，确保系统各部分协调运作。</li>
</ul>
<h2 id="2-应用服务设计"><a href="#2-应用服务设计" class="headerlink" title="2.应用服务设计"></a>2.应用服务设计</h2><p>在设计应用服务之前，我们先搞清楚什么是应用服务，以及重要性。</p>
<h3 id="应用服务的概念"><a href="#应用服务的概念" class="headerlink" title="应用服务的概念"></a>应用服务的概念</h3><p>应用服务是对一个或一组密切相关的业务对象及其操作的封装。</p>
<p>应用服务要明确定义自己的责任范围，将相关业务功能和对象组合在一起，避免暴露内部细节。</p>
<p>它需要整合因为同一原因变化的功能和数据，同时分离那些因为不同原因变化的部分。这样的设计方法，确保了服务的内聚性和灵活性。</p>
<p>应用服务的概念源自SOA（面向服务的架构）和微服务架构的兴起。通过把系统功能拆分成多个独立的服务，可以提高系统的可维护性、可扩展性和灵活性。</p>
<h3 id="应用服务如何划分？"><a href="#应用服务如何划分？" class="headerlink" title="应用服务如何划分？"></a>应用服务如何划分？</h3><p>应用服务在应用架构中非常重要，它把系统的核心功能“打包”起来，提供给外部的业务流程使用，可以看作是SaaS系统对外的“门面”。用户或者其他系统通过调用应用服务来实现特定的业务功能。那么，怎么设计应用服务呢？</p>
<p><strong>1、对齐业务能力，划分粒度适中的应用服务，职责单一。</strong></p>
<p>在划分应用服务粒度时，可以参考领域驱动设计（DDD）中的”限界上下文”概念。业务对象类似于限界上下文中的聚合根，是应用服务的核心。</p>
<p>通常情况下，我们会基于业务能力来划分应用服务，每个业务能力都对应一到多个独立的应用服务，每个应用服务用于支撑特定的业务能力。如图所示。</p>
<p>将应用服务与业务能力对齐，确保系统功能紧密贴合业务需求，避免技术实现与业务逻辑脱节。</p>
<p>如果一个应用服务支撑了过多的业务能力，需要评估其内部是否关联了过多的业务对象。在这种情况下，可以考虑将多个业务对象进行分组，从而将该应用服务拆分为多个更小、更专注的服务。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135333.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>2、围绕业务对象，提供具体的业务功能，避免包含不相关的功能。</strong></p>
<p>从外部来看，应用服务通常有明确的业务含义，主要围绕一个或一组密切相关的业务对象进行操作。</p>
<p>围绕业务对象设计服务可确保服务内部功能高度相关，提升内聚性。提供具体的业务功能让服务的边界更清晰，有利于业务团队和技术团队的协作与沟通。</p>
<p>例如，线上商城系统的”交易服务”专注于订单确认、下单和支付等功能，不应处理用户认证、商品推荐等其他业务。</p>
<h3 id="服务化架构的价值"><a href="#服务化架构的价值" class="headerlink" title="服务化架构的价值"></a>服务化架构的价值</h3><p>面向服务的架构最大的价值就在于它的敏捷性和灵活性。</p>
<p>敏捷性体现在服务可以快速调整，独立演进。灵活性体现在每个服务都有清晰的业务边界，功能内聚性强，能够单独管理生命周期。具体来说：</p>
<ol>
<li>轻量级应用：采用基于服务设计的轻应用，各个服务独立开发、部署和运营，可以独立交付，影响范围小，提升交付效率。</li>
<li>服务复用、灵活编排：通过服务的复用和灵活编排，可以快速响应业务的变化，支持复杂的业务流程。</li>
<li>局部扩展性高：系统被拆分为独立的服务后，容易进行横向扩展，只需要扩展必要的部分，成本更低，效果更好。</li>
</ol>
<h3 id="示例：订单履约应用服务划分"><a href="#示例：订单履约应用服务划分" class="headerlink" title="示例：订单履约应用服务划分"></a>示例：订单履约应用服务划分</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135344.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>如图所示，订单履约能力是零售企业业务能力地图中的 L2 级别业务能力。</p>
<p>订单履约能力可以细分为多个末级业务能力：面向消费者的履约服务、订单派单、订单管理、拣货管理、发货管理和逆向履约。</p>
<p>基于这些末级业务能力，我们就可以设计出对应的应用服务。</p>
<h2 id="3-应用结构设计"><a href="#3-应用结构设计" class="headerlink" title="3.应用结构设计"></a>3.应用结构设计</h2><p>在完成应用服务的设计后，我们需要深入地了解应用的内部结构。</p>
<p>应用结构设计是把应用服务的概念转化为具体实现的关键步骤。它描述了应用服务内部的层次结构和组织关系，决定了系统的模块化程度，以及后续开发和维护的难度。</p>
<h3 id="应用结构的抽象层次"><a href="#应用结构的抽象层次" class="headerlink" title="应用结构的抽象层次"></a>应用结构的抽象层次</h3><p>在设计应用结构时，我们通常会把系统分成不同的层次，比如系统级、应用级、模块级和代码级。</p>
<p>这种分层的方式有助于我们在不同层面处理复杂问题，确保系统结构清晰、易于维护。如图所示：</p>
<ul>
<li><strong>系统级：</strong>关注各个系统的整体布局和管理方式，比如系统之间的关系，以及它们如何协同工作。</li>
<li><strong>应用级：</strong>聚焦每个应用的整体架构，包括应用与其他应用的交互方式，以及它们在整个系统中的角色。</li>
<li><strong>模块级：</strong>对应用内部进行更细致的划分，涉及代码的模块化设计、数据和状态的管理等。通过合理的模块划分，可以提高代码的可维护性和可重用性，减少重复工作。</li>
<li><strong>代码级：</strong>关注代码本身的结构和实现方式，这一层的设计直接影响到代码的质量和实现细节。</li>
</ul>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135348.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>抽象层次的存在，是为了帮我们更有效地管理系统的复杂性。</p>
<p>通过把系统分成不同的抽象层次，我们可以更好地组织和理解系统结构，简化开发过程，提高代码的可维护性和可扩展性。</p>
<p>这种分层方法让开发团队能在不同层次上专注于特定的问题，更好地应对大型软件系统的挑战。具体来说有以下作用：</p>
<p><strong>1、分解复杂度</strong></p>
<p>如果把所有的业务细节、技术细节都混在一起，整个系统就会变得难以理解、维护和扩展。通过设置不同的抽象层次，我们可以把系统的复杂性分解到各个层次，每个层次只需关注特定的功能和职责。</p>
<p>这种分层处理方式让开发人员在专注于系统某一部分时，不用过多关注其他部分的细节，大大简化了系统的设计和开发过程。</p>
<p><strong>2、团队协作边界清晰</strong></p>
<p>在大型项目中，通常会有多个团队同时开发。如果系统没有明确的边界，各团队之间很容易产生冲突和重复劳动。</p>
<p>通过清晰的抽象层次划分，不同团队可以专注于系统的不同层次或模块，互不干扰。</p>
<p><strong>3、扩展性强</strong></p>
<p>随着业务需求的变化，系统往往需要不断地扩展和升级。如果系统的架构设计没有合理的抽象层次，扩展和升级就会变得非常困难，甚至可能需要对系统进行全面重构。</p>
<p>而在有抽象层次的系统中，变更通常只需聚焦在特定的层次上进行，而不会影响整个系统。比如，一次业务改动只影响模块级别，我们就可以在不改变系统整体架构的情况下，替换或新增某个模块，满足新的业务需求。</p>
<h3 id="应用结构如何划分？"><a href="#应用结构如何划分？" class="headerlink" title="应用结构如何划分？"></a>应用结构如何划分？</h3><p>在前面，我们提到了应用服务的设计方法，那么怎么把这些应用服务一步一步地转化成代码结构呢？</p>
<p>其实，应用服务是通过一系列的应用结构来实现的。如图所示。</p>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135352.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>基于应用服务的划分，我们可以进一步细化应用结构，更好地组织和管理系统功能。这个过程涉及到多个层次的设计方法：</p>
<ol>
<li>系统和子系统的划分要和业务域、业务子域的粒度保持一致。 这样，我们就能更好地把业务需求映射到技术实现上。</li>
<li>一个或多个相关的应用服务，可以组合成一个可独立部署的应用。</li>
<li>在应用内部，可以进一步分层。 比如，参考领域驱动设计（DDD）的分层方法，可以分为用户接口层、应用层、领域层和基础设施层。</li>
<li>应用的各个层级内部，还可以细分为多个模块，每个模块又包含多个代码单元。</li>
</ol>
<p>那么，具体来说，我们该怎么划分应用呢？可以参考以下几点原则：</p>
<p><strong>1、业务划分原则</strong></p>
<p>应用划分的关键是看应用服务的边界。</p>
<p>应用服务的核心目标是帮助企业实现业务能力，所以它们需要和业务能力保持一致。而应用是实际的物理部署单元，应用服务最终要部署在特定的应用上。</p>
<p>因此，一个或多个相关的应用服务，可以组合成一个可独立部署的应用。</p>
<p>应用服务可以单独部署，也可以多个服务合并部署。那么，如何判断何时选择独立部署，何时选择合并部署呢？这需要参考技术层面的成本和稳定性风险等因素。</p>
<p><strong>2、技术划分原则</strong></p>
<p>在业务初期，尽量从单体应用开始，避免过早地把应用拆得太细，这样可以减少分布式数据库事务和数据不一致的问题，并可以降低技术部署成本。然而，即使在单体应用内部，也需要将应用服务划分为界限分明的模块。</p>
<p>避免应用之间出现循环依赖或双向依赖。在应用单元内部，可以进一步分层，始终保持不同层级之间的单向依赖关系，高层级可以依赖低层级，同层级之间不应互相依赖。</p>
<p>只有当真正遇到技术上的痛点，比如规模、性能、安全等问题时，才考虑拆分应用。如果不拆分会严重影响业务的稳定性，那就应该拆分。但不要为了拆分而拆分，因为每次拆分都会增加系统的复杂度。</p>
<p><strong>3、组织规模原则</strong></p>
<p>划分后的单个应用的项目团队规模通常建议保持在10～12人左右。</p>
<p>因为团队成员越多，沟通的渠道就会成倍增加，可能导致信息传递变慢或者失真。一个10到12人的团队，可以确保大家的沟通更直接、更高效，减少信息障碍。</p>
<p>小团队更容易管理，项目经理或者团队领导能更好地了解每个成员的工作状态和需求，进行更有效的协调和支持。</p>
<p>同时，小团队有助于建立更紧密的合作关系，成员之间更容易培养出默契，提升整体工作效率和项目质量。</p>
<h3 id="示例：订单履约系统的应用结构划分"><a href="#示例：订单履约系统的应用结构划分" class="headerlink" title="示例：订单履约系统的应用结构划分"></a>示例：订单履约系统的应用结构划分</h3><p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135356.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>如图所示，是订单履约系统的应用结构划分。</p>
<ul>
<li>用户接口层：直接与用户交互的层级，负责向用户显示信息，响应用户命令。</li>
<li>应用层：定义软件的应用功能，它负责接收用户请求，协调领域层能力来执行任务，并将结果返回给用户，核心模块包括：</li>
<li>领域层：业务逻辑的核心，专注于表示业务概念、业务状态流转和业务规则，沉淀可复用的服务能力。</li>
</ul>
<h2 id="4-应用交互设计"><a href="#4-应用交互设计" class="headerlink" title="4.应用交互设计"></a>4.应用交互设计</h2><p>应用交互就是指不同应用之间怎么“沟通”和“交流”。</p>
<p>在一个复杂的系统中，各个应用可不是孤立存在的，它们需要互相配合，才能完成更复杂的业务流程。</p>
<p>应用交互的设计，就是为了确保这些系统和组件能够顺畅地“对话”，一起实现系统的整体目标。</p>
<p>应用交互的方式有很多种，包括同步调用、异步消息通信等等。每种方式都有特定的应用场景和优缺点。</p>
<p>通过合理的交互设计，系统中的各个部分能够高效协作，降低耦合度，增强系统的灵活性。</p>
<p>同时，好的交互设计还能显著提升系统的性能和容错能力，即使在高并发、大流量的情况下，也能保持稳定运行。</p>
<h3 id="应用服务的上下游"><a href="#应用服务的上下游" class="headerlink" title="应用服务的上下游"></a>应用服务的上下游</h3><p>应用服务是系统对外提供的核心业务功能。</p>
<p>虽然应用服务可以独立发展和演化，但它们必须相互交互，才能实现整个系统目标。</p>
<p>那么，如何设计应用服务之间的交互呢？首先，我们需要了解服务的上下游概念。</p>
<p><strong>1、服务上下游的概念</strong></p>
<p>服务的上下游关系可以通过DDD（领域驱动设计）的建模方法来定义，主要涉及“限界上下文”（bounded context）和“上下文映射”（context mapping）这两个概念。</p>
<p>上下游表示上下文之间的映射关系，下游需要了解上游的领域知识来实现业务，而上游不需要了解下游。</p>
<p>换句话说，上游服务不需要关心下游服务的存在，但下游服务的实现却依赖于上游服务提供的能力。</p>
<p>这个概念听起来有些抽象，确实让许多人犯迷糊。让我们通过线上商城的几个应用服务来具体说明：</p>
<ul>
<li>用户服务：管理用户的账户信息，包括注册、登录、认证、个人资料等，处理用户的权限和角色管理。</li>
<li>商品服务：管理商品的基本信息，包括名称、描述、价格、图片、分类等，提供商品的查询、筛选和浏览功能。</li>
<li>库存服务：管理商品的库存数量，处理库存的预占、扣减和回补操作。</li>
<li>交易服务：处理订单的创建、修改、取消和查询，管理订单的状态和生命周期。</li>
<li>支付服务：处理支付事务，支持多种支付方式，管理支付状态。</li>
<li>履约服务：处理订单的履约，包括拣货、包装、发货等，管理物流信息和配送状态。</li>
</ul>
<p><img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20250109135400.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>如图所示，我们可以看出各个服务的上下游关系。</p>
<p>商品服务和用户服务是上游服务，它们提供基础数据，其他服务依赖这些数据。</p>
<p>交易服务位于中间位置。对于用户服务和商品服务来说，交易服务是下游，因为它依赖这两个服务的基础数据。</p>
<p>对于库存服务来说，交易服务也是下游，因为交易下单过程中，需要库存服务来预占、扣减库存。</p>
<p>对于履约服务而言，交易服务是上游，因为它提供订单数据，驱动后续的订单履约流程。</p>
<p><strong>2、为什么要区分上下游？</strong></p>
<p>区分上下游关系的核心目标是为了解耦。</p>
<p>“解耦”这个词相信大家都不陌生，但它的含义往往过于抽象和模糊。在这里，我们探讨一下解耦到底指什么。</p>
<p>耦合是指两个或多个结构之间的相互作用和影响。在软件开发中，这可以理解为不同模块、系统或团队之间的相互依赖和影响。</p>
<p>随着业务需求越来越复杂，单个系统或团队很难独立实现所有功能。因此，解耦的目的并不是完全消除耦合，而是减少不必要的依赖关系。</p>
<p>前面提到，上游服务不需要关心下游服务的存在，但下游服务的实现却依赖上游服务提供的能力。</p>
<p>因此，当下游服务的团队在迭代新功能时，无需评估是否影响上游服务，因为基于明确的上下游关系，可以快速判断不会影响上游服务。只需评估是否影响自己的下游服务。</p>
<p>比如，交易服务的功能发生变更时，只需通知履约服务的团队，评估是否会影响到他们，上游服务团队则无需知晓。</p>
<p>这种方式能大大减少影响面的评估工作，提高团队协作效率。</p>
<p>相反，如果上下游关系混乱，存在各种循环依赖，那么任何一个服务的改动都难以准确评估影响面。此时，就需要召集所有服务的团队，逐一评估是否有影响。</p>
<p>在实际场景中，如果每次项目会议都需要拉一大群人才能评估出影响面，这样的协作效率就太低了。</p>
<p><strong>3、上下游关系的核心使用场景</strong></p>
<p>在软件研发过程中，上下游关系在很多关键场景中都发挥着重要作用：</p>
<ul>
<li>明确服务之间的依赖关系：上下游关系让开发者清晰地了解服务间的依赖。这有助于减少不合理的依赖，确保服务的独立性和模块化设计。同时，它也避免了服务间的循环依赖，降低了一个服务出现故障引发连锁反应的风险。</li>
<li>评估影响面：当上游服务变更时，可以预见其对下游服务的影响，从而制定相应的应对策略。</li>
<li>指导团队协作：上下游关系有助于明确各团队的职责和工作范围。上游团队需要考虑下游团队的需求，提供稳定的接口和服务；下游团队则需要适应上游的变化。</li>
</ul>
<h3 id="应用服务的交互方式"><a href="#应用服务的交互方式" class="headerlink" title="应用服务的交互方式"></a>应用服务的交互方式</h3><p>应用服务之间的交互方式有很多，最主要的就是同步调用和异步消息。</p>
<p><strong>1、同步调用</strong></p>
<p>同步调用是一种通信方式，调用方（客户端）向被调用方（服务端）发送请求，然后等待服务端处理完再返回结果。</p>
<p>在这期间，调用方会被“堵住”，直到收到服务端的响应。这种方式要求双方都在线，而且调用方在等待响应时，没法做别的事。</p>
<p>在微服务架构中，常用的同步调用协议包括 HTTP、REST API、Dubbo、Thrift、gRPC 和 SOAP 等。</p>
<p>同步调用适用于下游服务需要立刻从上游服务获取数据或功能的场景。这种方式简单直接，但需要处理服务之间的可用性问题。</p>
<p>举个例子，用户下单时，订单服务需要同步调用商品服务，获取商品的最新价格和库存信息，确保订单有效。</p>
<p>通常来说，上游服务不应同步调用下游服务。如果上游服务同步调用下游服务，会导致上游需要了解下游的领域知识，违背DDD上下游的设计原则，加深系统耦合，并增加团队协作复杂性。</p>
<p>此外，这种做法还可能引发级联故障，降低系统可靠性。如果上下游直接互相调用，那下游服务发生故障时，也将直接影响上游服务的可用性，可能导致整个系统都瘫痪。</p>
<p><strong>2、异步消息</strong></p>
<p>异步消息是另一种通信方式，消息的发送者（生产者）和接收者（消费者）通过消息队列或消息中间件进行通信。</p>
<p>发送者发完消息就可继续其他操作，不用等接收者处理完。消息被发送到消息队列后，接收者从队列中异步获取并处理。这样一来，发送者和接收者的处理时间就不耦合了，双方可以各自独立运作，提高了系统的灵活性和可扩展性。</p>
<p>在微服务架构中，异步消息通常通过消息中间件实现，比如 RabbitMQ、Kafka、RocketMQ 等。</p>
<p>异步消息适用于上游服务向下游服务发布事件或通知的场景，能有效解耦服务，提高系统的弹性和可靠性。下游服务也可以通过异步消息向上游服务反馈信息，实现双向通信。</p>
<p>比如，用户提交订单后，订单服务调用支付服务发起支付。用户完成支付后，支付服务发布一个“支付成功”的消息，订单服务接收到消息后，更新订单状态并发送通知。</p>
<p><strong>3、其他交互方式</strong></p>
<p>1）共享数据库方式</p>
<p>多个服务访问同一个数据库，直接读取或写入数据。</p>
<p>在微服务架构中，通常不建议采用共享数据库的方式，因为这违反了服务自治的原则，增加了服务之间的耦合度。</p>
<p>2）文件传输</p>
<p>服务之间通过共享文件系统或 FTP 等方式交换数据文件。这种方式一般适用于批处理的场景，实时性较差。</p>
<p>3）服务总线（ESB）</p>
<p>使用统一的通信总线来连接不同的服务和系统。服务之间不直接通信，而是通过总线来“中转”，适用于需要集成多种异构系统和服务的大型企业级系统。</p>
<p>但是，这种方式引入了额外的架构层，增加了系统的复杂性。所有服务都耦合到总线上，存在单点故障的风险。</p>

              
            </div>
            <hr/>
            <div>
              <div>
  <img src="https://jy-imgs.oss-cn-beijing.aliyuncs.com/img/20241112163319.png" srcset="/img/loading.gif" lazyload>
</div>
<div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/17-%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/" class="category-chain-item">17_项目设计</a>
  
  
    <span>></span>
    
  <a href="/categories/17-%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/01-%E4%B8%9A%E5%8A%A1%E8%AE%BE%E8%AE%A1/" class="category-chain-item">01_业务设计</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/">#系统设计</a>
      
        <a href="/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">#架构设计</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>07-Saas系统业务架构设计</div>
      <div>https://janycode.github.io/2025/01/09/17_项目设计/01_业务设计/07-SaaS系统业务架构设计/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Jerry(姜源)</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年1月9日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 姜源">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/01/21/12_%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/06_PMP/04-%E5%A6%82%E4%BD%95%E5%86%99%E5%A5%BDB%E7%AB%AF%E4%BA%A7%E5%93%81%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/" title="04-如何写好B端产品技术方案">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">04-如何写好B端产品技术方案</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/01/06/17_%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/03_%E5%9C%BA%E6%99%AF%E8%AE%BE%E8%AE%A1/03-%E5%9F%BA%E4%BA%8EAOP%E6%8B%86%E5%88%86IN%E6%9F%A5%E8%AF%A2%E6%8F%90%E9%AB%98%E6%9F%A5%E8%AF%A2%E6%95%88%E7%8E%87/" title="03-基于AOP拆分IN查询提高查询效率">
                        <span class="hidden-mobile">03-基于AOP拆分IN查询提高查询效率</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="SOHUCS" sid='https://janycode.github.io/2025/01/09/17_%E9%A1%B9%E7%9B%AE%E8%AE%BE%E8%AE%A1/01_%E4%B8%9A%E5%8A%A1%E8%AE%BE%E8%AE%A1/07-SaaS%E7%B3%BB%E7%BB%9F%E4%B8%9A%E5%8A%A1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/'></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#SOHUCS', function() {
      Fluid.utils.createScript("https://changyan.sohu.com/upload/changyan.js", function() {
        window.changyan.api.config({"appid":"cyw5OHIcO","appkey":"fea3446b3df4b3f129f34da4cbc87e51"})
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://simple.blog.csdn.net" target="_blank" rel="nofollow noopener"><span>CSDN</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/janycode" target="_blank" rel="nofollow noopener"><span>GitHub</span></a> <i class="iconfont icon-love"></i> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量(PV) 
        <span id="busuanzi_value_site_pv"></span>
         次，
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数(UV) 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

<!-- live2d 动画 -->
<script src="https://eqcn.ajz.miesnfu.com/wp-content/plugins/wp-3d-pony/live2dw/lib/L2Dwidget.min.js"></script>
<script>
    L2Dwidget.init({
        "model": {
            jsonPath: "https://unpkg.com/live2d-widget-model-haruto@1.0.5/assets/haruto.model.json",
            "scale": 1
        },
        "display": {
            "position": "right",
            "width": 100,
            "height": 200,
            "hOffset": 35,
            "vOffset": -85
        },
        "mobile": {
            "show": false,
            "scale": 0.1
        },
        "react": {
            "opacityDefault": 0.75,
            "opacityOnHover": 0.2
        }
    });
</script>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <!-- Baidu Analytics -->
    <script defer>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?bfff735c897eb60ea49b735096b20e47";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  

  

  

  

  

  




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
